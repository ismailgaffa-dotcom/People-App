<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø·Ù‚Ø³ AI - Ø®Ø¨ÙŠØ± Ø§Ù„Ø£Ø±ØµØ§Ø¯ Ø§Ù„Ø°ÙƒÙŠ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0e1621; /* Ù„ÙˆÙ† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù„ÙŠÙ„ÙŠ */
            background-image: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');
            height: 100vh; display: flex; flex-direction: column;
        }
        /* Header - Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ Ù…Ø«Ù„ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… */
        .header {
            background: #242f3d; color: white; padding: 10px 20px;
            display: flex; align-items: center; gap: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .header img { width: 40px; height: 40px; border-radius: 50%; background: #10a37f; }

        .chat-area { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        
        /* ÙÙ‚Ø§Ø¹Ø§Øª Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        .msg { max-width: 80%; padding: 12px 18px; border-radius: 15px; position: relative; line-height: 1.6; }
        .ai-msg { background: #2b5278; color: white; align-self: flex-start; border-bottom-right-radius: 2px; }
        .user-msg { background: #182533; color: #8295ad; align-self: flex-end; border-bottom-left-radius: 2px; }

        .weather-card { background: rgba(0,0,0,0.2); border-radius: 10px; padding: 10px; margin-top: 10px; border-right: 3px solid #64b5f6; }
        .warning { color: #ff5252; font-weight: bold; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .input-container { background: #242f3d; padding: 15px; display: flex; gap: 10px; }
        input { flex: 1; background: #17212b; border: none; border-radius: 20px; padding: 12px 20px; color: white; outline: none; }
        button { background: #5288c1; border: none; color: white; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; }
    </style>
</head>
<body>

    <div class="header">
        <div class="avatar-icon" style="width:40px; height:40px; border-radius:50%; background:#5288c1; display:flex; align-items:center; justify-content:center; font-weight:bold;">W</div>
        <div>
            <div style="font-weight: bold;">Ø§Ù„Ø·Ù‚Ø³ AI</div>
            <div style="font-size: 12px; color: #8295ad;">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù† - Ø®Ø¨ÙŠØ± Ø§Ù„Ø£Ø±ØµØ§Ø¯</div>
        </div>
    </div>

    <div class="chat-area" id="chat">
        <div class="msg ai-msg">
            Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ <b>Ø§Ù„Ø·Ù‚Ø³ AI</b> â›ˆï¸.
            Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ø£Ø¹Ø·ÙŠÙƒ ØªÙ‚Ø±ÙŠØ±Ø§Ù‹ Ø´Ø§Ù…Ù„Ø§Ù‹ (Ø§Ù„Ø­Ø±Ø§Ø±Ø©ØŒ Ø§Ù„Ø±ÙŠØ§Ø­ØŒ Ø§Ù„Ø±Ø·ÙˆØ¨Ø©ØŒ ÙˆØ§Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª).
            Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¢Ù†:
        </div>
    </div>

    <div class="input-container">
        <input type="text" id="cityInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©..." onkeypress="if(event.key === 'Enter') getAdvancedWeather()">
        <button onclick="getAdvancedWeather()"><i class="fas fa-paper-plane"></i></button>
    </div>

    <script>
        async function getAdvancedWeather() {
            const input = document.getElementById('cityInput');
            const city = input.value.trim();
            if(!city) return;

            addMsg('user', city);
            input.value = '';

            try {
                const geo = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${city}&count=1&language=ar`);
                const geoData = await geo.json();
                if(!geoData.results) { addMsg('ai', 'Ù„Ù… Ø£Ø³ØªØ·Ø¹ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.'); return; }

                const {latitude, longitude, name} = geoData.results[0];
                const w = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&hourly=relativehumidity_2m,precipitation_probability`);
                const wData = await w.json();

                const temp = wData.current_weather.temperature;
                const wind = wData.current_weather.windspeed;
                const rainProb = wData.hourly.precipitation_probability[0];
                
                let report = `ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø·Ù‚Ø³ Ù„Ù…Ø¯ÙŠÙ†Ø© <b>${name}</b>: <br><br>`;
                report += `ğŸŒ¡ï¸ Ø§Ù„Ø­Ø±Ø§Ø±Ø©: ${temp}Â°C <br>`;
                report += `ğŸ’¨ Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­: ${wind} ÙƒÙ…/Ø³ <br>`;
                report += `â˜” Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ø£Ù…Ø·Ø§Ø±: ${rainProb}% <br>`;

                // Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒÙŠ
                if(wind > 50) report += `<div class="warning">âš ï¸ ØªØ­Ø°ÙŠØ±: Ø±ÙŠØ§Ø­ Ù‚ÙˆÙŠØ© Ø¬Ø¯Ø§Ù‹!</div>`;
                if(rainProb > 80) report += `<div class="warning">ğŸŒŠ Ø®Ø·Ø± ÙÙŠØ¶Ø§Ù†Ø§Øª Ù…Ø­Ù„ÙŠ: Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø£Ù…Ø·Ø§Ø± Ø¹Ø§Ù„ÙŠØ©!</div>`;
                if(temp > 40) report += `<div class="warning">â˜€ï¸ ØªÙ†Ø¨ÙŠÙ‡: Ù…ÙˆØ¬Ø© Ø­Ø± Ø´Ø¯ÙŠØ¯Ø©!</div>`;
                
                if(wind <= 50 && rainProb <= 80 && temp <= 40) report += `<br>âœ… Ø§Ù„Ø£Ø¬ÙˆØ§Ø¡ Ù…Ø³ØªÙ‚Ø±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ ${name}.`;

                addMsg('ai', report);
            } catch(e) { addMsg('ai', 'Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙˆØ§Ø¬Ù‡Øª Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©.'); }
        }

        function addMsg(type, text) {
            const chat = document.getElementById('chat');
            const div = document.createElement('div');
            div.className = `msg ${type}-msg`;
            div.innerHTML = text;
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        }
    </script>
</body>
</html>

